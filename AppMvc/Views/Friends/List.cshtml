@model AppMvc.Models.ViewModels.Friends.FriendsListViewModel
@{
    ViewData["Title"] = "Friends List";
}
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

<section class="mb-4">
    <div class="row align-items-center mb-4">
        <div class="col-md-8">
            <h1 class="h2 mb-2 text-primary fw-bold">Friends List</h1>
            <p class="text-muted mb-0">Browse and manage your friends database</p>
        </div>
        <div class="col-md-4 text-md-end">
            <span class="badge bg-primary fs-6 px-3 py-2">@Model.NrOfFriends Total</span>
        </div>
    </div>
</section>

    <form method="post" asp-controller="Friends" asp-action="Search" class="needs-validation" novalidate>
        <div class="card border-0 shadow-sm mb-4">
            <div class="card-body p-4">
                <div class="row align-items-center g-3">
                    <div class="col-md-6">
                        <div class="input-group">
                            <span class="input-group-text bg-white">
                                <svg class="bi text-muted" width="16" height="16"><use xlink:href="#globe2" /></svg>
                            </span>
                            <input asp-for="SearchFilter" class="form-control border-start-0" type="search" 
                                   placeholder="Search by Name, Country or City" aria-label="Search">
                        </div>
                    </div>
                    <div class="col-md-3">
                        <button class="btn btn-primary w-100" type="submit">
                            <svg class="bi me-2" width="16" height="16"><use xlink:href="#globe2" /></svg>
                            Search
                        </button>
                    </div>
                    <div class="col-md-3">
                        <div class="form-check">
                            <input asp-for="UseSeeds" class="form-check-input" type="checkbox" id="useSeeds">
                            <label class="form-check-label" for="useSeeds">Use seeded data</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <!-- This is where selected item id will be stored -->
                <input type="hidden" name="id" data-seido-selected-item-id-target />

                @if (Model.FriendsList is not null)
                {
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead class="bg-light">
                                <tr>
                                    <th scope="col" class="py-3 px-4">Friend Name</th>
                                    <th scope="col" class="py-3">Country</th>
                                    <th scope="col" class="py-3">City</th>
                                    <th scope="col" class="py-3 text-end">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.FriendsList)
                                {
                                    <tr>
                                        <td class="py-3 px-4">
                                            <a asp-controller="Friends" asp-action="Details" asp-route-id="@item.FriendId" 
                                               class="text-decoration-none fw-medium text-dark">
                                                <svg class="bi text-primary me-2" width="16" height="16">
                                                    <use xlink:href="#person-raised-hand" />
                                                </svg>
                                                @item.FirstName @item.LastName
                                            </a>
                                        </td>
                                        <td class="py-3">
                                            <span class="text-muted">@(item.Address?.Country ?? "No country")</span>
                                        </td>
                                        <td class="py-3">
                                            <span class="text-muted">@(item.Address?.City ?? "No city")</span>
                                        </td>
                                        <td class="py-3 text-end">
                                            <a asp-controller="Friends" asp-action="Edit" asp-route-id="@item.FriendId" 
                                               class="btn btn-sm btn-outline-primary me-1">
                                                <svg class="bi" width="14" height="14"><use xlink:href="#edit" /></svg>
                                                Edit
                                            </a>
                                            <button type="button" class="btn btn-sm btn-outline-danger" 
                                                    data-bs-toggle="modal" data-bs-target="#delModal" 
                                                    data-seido-modal-body="@item.FirstName @item.LastName is about to be deleted."
                                                    data-seido-selected-item-id="@item.FriendId">
                                                <svg class="bi" width="14" height="14"><use xlink:href="#undo" /></svg>
                                                Delete
                                            </button>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                    <div class="card-footer bg-white border-0 py-3">
                        <nav aria-label="Page navigation">
                            <ul class="pagination pagination-sm justify-content-center mb-0">
                                <li class="page-item">
                                    <a class="page-link" 
                                       asp-controller="Friends" asp-action="List" asp-route-pagenr="@Model.PrevPageNr" asp-route-searchFilter="@Model.SearchFilter" asp-route-useSeeds="@Model.UseSeeds"
                                       aria-label="Previous">
                                        <span aria-hidden="true">&laquo; Previous</span>
                                    </a>
                                </li>
                                @for (int i = 0; i < Model.NrVisiblePages; i++)
                                {
                                    <li class="page-item @(i == Model.ThisPageNr ? "active" : "")">
                                        <a class="page-link" 
                                           asp-controller="Friends" asp-action="List" asp-route-pagenr="@i" asp-route-searchFilter="@Model.SearchFilter" asp-route-useSeeds="@Model.UseSeeds">@(i + 1)</a>
                                    </li>
                                }
                                <li class="page-item">
                                    <a class="page-link" 
                                       asp-controller="Friends" asp-action="List" asp-route-pagenr="@Model.NextPageNr" asp-route-searchFilter="@Model.SearchFilter" asp-route-useSeeds="@Model.UseSeeds"
                                       aria-label="Next">
                                        <span aria-hidden="true">Next &raquo;</span>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                }
            </div>
        </div>

        <!-- Delete Confirmation Modal -->
        <div class="modal fade" id="delModal" tabindex="-1" aria-labelledby="delModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow">
                    <div class="modal-header border-0 pb-0">
                        <h5 class="modal-title text-danger fw-bold" id="delModalLabel">
                            <svg class="bi me-2" width="20" height="20"><use xlink:href="#undo" /></svg>
                            Confirm Deletion
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body py-4">
                        <p class="mb-0">Hello from modal</p>
                    </div>
                    <div class="modal-footer border-0 pt-0">
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" formaction="@Url.Action("Delete", "Friends")" class="btn btn-danger">
                            <svg class="bi me-1" width="14" height="14"><use xlink:href="#undo" /></svg>
                            Delete Friend
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </form>

@section script
{
    <!-- -->
    <partial name="_ValidationScriptsPartial" />
}